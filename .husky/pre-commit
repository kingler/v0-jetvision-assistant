#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# JetVision Multi-Agent Code Review - Pre-commit Hook
# Uses morpheus-validator for automated code quality checks

echo "ğŸ” Running Morpheus Validator pre-commit checks..."

# Run type checking
npm run type-check || {
  echo "âŒ Type check failed. Fix TypeScript errors before committing."
  exit 1
}

# Run linting
npm run lint || {
  echo "âŒ Linting failed. Fix linting errors before committing."
  exit 1
}

# Run unit tests for changed files
npm run test:unit -- --run --changed || {
  echo "âŒ Unit tests failed. Fix failing tests before committing."
  exit 1
}

# Run code review validation
npm run review:validate || {
  echo "âš ï¸  Code review validation found issues. Review the output above."
  echo "ğŸ’¡ Run 'npm run review:fix' to automatically fix some issues."
  exit 1
}

echo "âœ… Pre-commit checks passed!"
