# UAT Instructions: ONEK-197

**Issue**: [ONEK-197] TripSummaryCard shows one-way for round-trip requests
**Date Generated**: 2026-02-08
**Branch**: `kinglerbercy/onek-197-bug-tripsummarycard-shows-one-way-for-round-trip-requests` (commit `890991a`)
**Status**: Done
**Priority**: High
**Author**: Generated by Claude Code `/uat_instructions`

---

## Overview

This bug fix addresses the TripSummaryCard component (`components/avinode/trip-summary-card.tsx`) incorrectly displaying round-trip flight requests as one-way. Previously, the component lacked `tripType`, `returnDate`, and return airport props, causing it to render only a single flight path (e.g., "KTEB -> KVNY") with only the outbound date. After the fix, round-trip requests now display a two-way arrow (KTEB <-> KVNY) with both outbound and return dates.

---

## Acceptance Criteria

### AC-1: Round-Trip Requests Display Two-Way Arrow and Both Dates

**Given** a chat session contains a round-trip flight request (e.g., KTEB to KVNY, outbound Mar 2, return Mar 5)
**When** the user views the "Step 1: Trip Request Created" card in the chat thread
**Then** the TripSummaryCard displays a two-way arrow between airports (KTEB <-> KVNY) and shows both the outbound date (Mar 2, 2026) and the return date (Mar 5, 2026)

### AC-2: One-Way Requests Continue to Display Single Arrow

**Given** a chat session contains a one-way flight request (e.g., KTEB to KLAX, one-way on Mar 10)
**When** the user views the trip summary card in the chat thread
**Then** the TripSummaryCard displays a one-way arrow (KTEB -> KLAX) with only the outbound date, and no return date section is visible

### AC-3: Return Airport Information Renders When Different from Outbound

**Given** a round-trip flight request where the return leg departs from a different airport than the outbound arrival (e.g., outbound KTEB -> KVNY, return KBUR -> KTEB)
**When** the TripSummaryCard renders
**Then** the return leg correctly displays the return departure airport (KBUR) and return arrival airport (KTEB), not duplicating the outbound airports

### AC-4: Missing Return Data Degrades Gracefully

**Given** a round-trip request where the `returnDate` or return airport fields are null or undefined in the data
**When** the TripSummaryCard renders
**Then** the component renders the outbound leg correctly without crashing, and the return section is hidden or displays a fallback (no blank or broken UI elements)

---

## Test Steps

### Test 1: Round-Trip Display Verification (Maps to AC-1)

1. Open the application at `http://localhost:3001`
2. Navigate to the existing CJTQML chat session (or create a new round-trip request: "I need a flight from Teterboro to Van Nuys, departing March 2 and returning March 5")
3. Locate the "Step 1: Trip Request Created" card in the chat thread
4. Inspect the route display
   - **Expected**: Route shows two-way arrow notation (e.g., "KTEB <-> KVNY" or equivalent round-trip indicator)
5. Inspect the date display
   - **Expected**: Both outbound date (Mar 2, 2026) and return date (Mar 5, 2026) are visible on the card
6. Verify both legs are labeled (outbound vs. return)
   - **Expected**: Each date is clearly associated with its respective leg

**Result**: [ ] Pass  [ ] Fail

**Notes**: _______________

---

### Test 2: One-Way Request Regression (Maps to AC-2)

1. Open the application at `http://localhost:3001`
2. Create a new one-way flight request: "I need a one-way flight from Teterboro to Los Angeles on March 10"
3. Wait for the agent to create the trip
4. Locate the trip summary card in the chat
5. Inspect the route display
   - **Expected**: Route shows a single-direction arrow (KTEB -> KLAX)
6. Inspect the date display
   - **Expected**: Only one date is displayed (Mar 10, 2026). No "return" section or empty date placeholder
7. Confirm no visual glitches or extra whitespace where a return section would be
   - **Expected**: Card layout is clean with no empty gaps

**Result**: [ ] Pass  [ ] Fail

**Notes**: _______________

---

### Test 3: Different Return Airports (Maps to AC-3)

1. Open the application at `http://localhost:3001`
2. Create a round-trip request where the return departs from a different airport (if supported by the agent): "I need a flight from KTEB to KVNY departing March 2, returning from Burbank to Teterboro on March 5"
3. Locate the trip summary card
4. Inspect the return leg information
   - **Expected**: Return leg shows KBUR -> KTEB (not KVNY -> KTEB)
5. If the system does not support asymmetric returns, verify the return airports default to the outbound pair reversed
   - **Expected**: No crash or data mismatch

**Result**: [ ] Pass  [ ] Fail

**Notes**: _______________

---

### Test 4: Graceful Degradation with Missing Data (Maps to AC-4)

1. Open browser DevTools and navigate to the Network tab
2. Locate a round-trip chat session
3. Inspect the API response for the chat messages to identify the trip data structure
4. Verify the component handles edge cases:
   - If `returnDate` is `null`, the return section should be hidden
   - If `returnAirport` fields are missing, the card should not display broken airport codes
   - **Expected**: No console errors, no blank sections, no "undefined" text displayed in the card
5. Check browser console for React rendering errors
   - **Expected**: Zero errors related to TripSummaryCard props

**Result**: [ ] Pass  [ ] Fail

**Notes**: _______________

---

## Test Data & Environment

### Environment Requirements

- **URL**: `http://localhost:3001` (development) or staging URL
- **Branch**: `main` (commit `890991a` merged)
- **Setup**: `npm install && npm run dev`

### Test Data

- **Existing round-trip session**: CJTQML (KTEB to KVNY, Mar 2 - Mar 5)
- **One-way test**: Create new session with "I need a one-way flight from KTEB to KLAX on March 10"
- **Round-trip test**: Create new session with "I need a flight from Teterboro to Van Nuys, departing March 2 and returning March 5"

### Pre-Test Setup

1. Ensure all dependencies are installed: `npm install`
2. Start the development server: `npm run dev`
3. Verify the CJTQML session is accessible in the sidebar

---

## Sign-Off

| Tester | Role | Result | Date | Signature |
|--------|------|--------|------|-----------|
| @AB | QA Lead | [ ] Pass [ ] Fail | ____-__-__ | _________ |
| @Kham | Developer | [ ] Pass [ ] Fail | ____-__-__ | _________ |

### Final Disposition

- [ ] All tests passed -- ready for production
- [ ] Issues found -- see notes above
- [ ] Blocked -- requires {description}

---

*Generated by `/uat_instructions ONEK-197` on 2026-02-08*
