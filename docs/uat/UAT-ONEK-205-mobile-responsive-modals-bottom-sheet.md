# UAT Instructions: ONEK-205

**Issue**: [ONEK-205] Mobile responsive modals with iOS-style bottom sheet drawers
**Date Generated**: 2026-02-08
**Branch**: `kinglerbercy/onek-205-feat-mobile-responsive-modals-with-ios-style-bottom-sheet` (related commits `8faa5ae`, `88def07`)
**Status**: Done
**Priority**: High
**Author**: Generated by Claude Code `/uat_instructions`

---

## Overview

This feature makes the Jetvision application fully responsive for mobile devices by converting all modal/dialog components to use iOS-style bottom sheet drawers on mobile viewports (<768px) while maintaining centered overlay dialog behavior on desktop (>=768px). New files include `use-mobile.ts` hook, `drawer.tsx` primitives (Vaul-based), and `responsive-modal.tsx` smart wrapper. Five modal components were migrated: CustomerSelectionDialog, BookFlightModal, PaymentConfirmationModal, MarginEditModal, and QuoteDetailsDrawer.

---

## Acceptance Criteria

### AC-1: Mobile Modals Render as Bottom Sheet Drawers

**Given** the app is viewed on a mobile viewport (<768px width)
**When** the user triggers any modal (CustomerSelectionDialog, BookFlightModal, PaymentConfirmationModal, MarginEditModal, or QuoteDetailsDrawer)
**Then** the modal renders as a bottom sheet drawer that slides up from the bottom of the screen with a visible drag handle at the top

### AC-2: Desktop Modals Render as Centered Overlay Dialogs

**Given** the app is viewed on a desktop viewport (>=768px width)
**When** the user triggers any of the same modals
**Then** the modal renders as a traditional centered overlay dialog (no behavior change from previous implementation)

### AC-3: Bottom Sheet Drawers Are Dismissible via Swipe and Tap-Outside

**Given** a bottom sheet drawer is open on a mobile viewport
**When** the user swipes the drawer downward or taps outside the drawer area
**Then** the drawer dismisses with a smooth slide-down animation and the underlying content is accessible again

### AC-4: Touch Targets Meet 44px Minimum on Mobile

**Given** any modal is open on a mobile viewport
**When** the user examines interactive elements (buttons, inputs, dropdown items)
**Then** all interactive elements have a minimum touch target size of 44x44 pixels

### AC-5: Text Scales Appropriately Between Viewports

**Given** any modal is open
**When** the viewport transitions between mobile (<768px) and desktop (>=768px)
**Then** text scales from `text-xs`/`text-sm` on mobile to `text-sm`/`text-base` on desktop with no horizontal scrolling at any viewport size

### AC-6: No Desktop Regressions

**Given** the app is used on a desktop viewport (>=768px)
**When** the user performs all existing modal workflows (generate proposal, book flight, edit margin, confirm payment, view quote details)
**Then** all modals render and function identically to their pre-migration behavior with zero visual or functional differences

---

## Test Steps

### Test 1: Mobile Bottom Sheet Rendering (Maps to AC-1)

1. Open the application at `http://localhost:3001` in Chrome
2. Open DevTools (F12) and toggle Device Toolbar (Ctrl+Shift+M or Cmd+Shift+M)
3. Select iPhone 14 Pro (390x844) or any mobile preset
4. Navigate to a chat session with an existing flight request (e.g., CJTQML)
5. Trigger the **CustomerSelectionDialog**: Click "Generate Proposal" on a flight card
   - **Expected**: Modal slides up from the bottom as a drawer with a drag handle visible at the top
6. Close the drawer and trigger the **BookFlightModal**: Click "Book Flight" on an accepted quote
   - **Expected**: Modal renders as a bottom sheet drawer
7. Trigger the **MarginEditModal**: Click "Edit Service Charge" on a sent proposal
   - **Expected**: Modal renders as a bottom sheet drawer with preset buttons wrapping on narrow width
8. Trigger the **PaymentConfirmationModal**: Click "Mark Payment Received" on a contract
   - **Expected**: Modal renders as a bottom sheet drawer with touch-friendly form inputs
9. Trigger the **QuoteDetailsDrawer**: Click on a quote card to view details
   - **Expected**: Modal renders as a bottom sheet drawer (85vh max height), not a right-side panel

**Result**: [ ] Pass  [ ] Fail

**Notes**: _______________

---

### Test 2: Desktop Dialog Preservation (Maps to AC-2, AC-6)

1. Switch DevTools to a desktop viewport (1280x800 or larger) or turn off Device Toolbar
2. Trigger the **CustomerSelectionDialog**: Click "Generate Proposal"
   - **Expected**: Modal renders as a centered overlay dialog (traditional modal)
3. Trigger the **BookFlightModal**: Click "Book Flight"
   - **Expected**: Centered overlay with full pricing and flight details visible
4. Trigger each remaining modal (MarginEditModal, PaymentConfirmationModal, QuoteDetailsDrawer)
   - **Expected**: All render as centered overlays or right-side panels (QuoteDetailsDrawer), identical to pre-migration behavior
5. Verify all modal functionality works (form submissions, button clicks, data display)
   - **Expected**: No functional regressions on desktop

**Result**: [ ] Pass  [ ] Fail

**Notes**: _______________

---

### Test 3: Swipe-Down and Tap-Outside Dismissal (Maps to AC-3)

1. Switch to mobile viewport (iPhone 14 Pro, 390x844)
2. Open any bottom sheet drawer
3. Swipe down on the drag handle or drawer content area
   - **Expected**: Drawer slides down and closes with smooth animation
4. Open the drawer again
5. Tap on the overlay/backdrop area outside the drawer
   - **Expected**: Drawer dismisses
6. Verify the underlying page content is fully accessible after dismissal
   - **Expected**: No frozen UI or lingering overlay

**Result**: [ ] Pass  [ ] Fail

**Notes**: _______________

---

### Test 4: Touch Target Sizes (Maps to AC-4)

1. On mobile viewport, open the CustomerSelectionDialog
2. Inspect button and input elements using DevTools Elements panel
3. Measure the rendered height of interactive elements
   - **Expected**: All buttons have minimum height of 44px
4. Check dropdown/select items for touch target sizing
   - **Expected**: Each selectable item is at least 44px tall
5. Repeat for PaymentConfirmationModal form inputs (text inputs, selects)
   - **Expected**: All inputs meet 44px minimum touch target

**Result**: [ ] Pass  [ ] Fail

**Notes**: _______________

---

### Test 5: Responsive Text Scaling (Maps to AC-5)

1. Open a modal on mobile viewport (390px)
2. Check text sizes in the modal content
   - **Expected**: Text uses smaller sizes (`text-xs` or `text-sm`), fitting within the viewport without horizontal scrolling
3. Switch to desktop viewport (1280px)
4. Open the same modal
   - **Expected**: Text uses larger sizes (`text-sm` or `text-base`), utilizing available space
5. Slowly resize the viewport across the 768px breakpoint
   - **Expected**: Text transitions smoothly, no layout jumps or overlapping text

**Result**: [ ] Pass  [ ] Fail

**Notes**: _______________

---

### Test 6: Breakpoint Transition (Maps to AC-5, AC-6)

1. Open a modal on desktop viewport
2. Slowly resize the browser window below 768px
   - **Expected**: Modal transitions from centered overlay to bottom sheet drawer smoothly
3. Resize back above 768px
   - **Expected**: Modal transitions back to centered overlay
4. Verify no visual artifacts or stuck states during transition
   - **Expected**: Clean transition with no leftover overlays or mispositioned content

**Result**: [ ] Pass  [ ] Fail

**Notes**: _______________

---

## Test Data & Environment

### Environment Requirements

- **URL**: `http://localhost:3001` (development) or staging URL
- **Branch**: `main` (merged)
- **Setup**: `npm install && npm run dev`
- **Browser**: Chrome (for DevTools device emulation)

### Test Data

- **Session with flight request**: CJTQML (round-trip KTEB to KVNY)
- **Modals to test**: CustomerSelectionDialog, BookFlightModal, PaymentConfirmationModal, MarginEditModal, QuoteDetailsDrawer
- **Mobile viewports**: iPhone 14 Pro (390x844), iPhone SE (375x667), iPad Mini (768x1024)
- **Desktop viewport**: 1280x800 or larger

### Pre-Test Setup

1. Ensure all dependencies are installed: `npm install`
2. Ensure Vaul package is installed: `npm list vaul` (should show ^0.9.9+)
3. Start the development server: `npm run dev`
4. Verify a chat session with full workflow data (quotes, proposals, contracts) is available

---

## Sign-Off

| Tester | Role | Result | Date | Signature |
|--------|------|--------|------|-----------|
| @AB | QA Lead | [ ] Pass [ ] Fail | ____-__-__ | _________ |
| @Kham | Developer | [ ] Pass [ ] Fail | ____-__-__ | _________ |

### Final Disposition

- [ ] All tests passed -- ready for production
- [ ] Issues found -- see notes above
- [ ] Blocked -- requires {description}

---

*Generated by `/uat_instructions ONEK-205` on 2026-02-08*
